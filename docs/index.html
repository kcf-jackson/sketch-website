<!doctype html>
<html lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.72">
<link rel="alternate" type="application/rss+xml" href="/sketch-website/blog/rss.xml" title="Sketch Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/sketch-website/blog/atom.xml" title="Sketch Blog Atom Feed"><title data-react-helmet="true">Introduction | Sketch</title><meta data-react-helmet="true" property="og:url" content="https://kcf-jackson.github.io/sketch-website/docs/"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Introduction | Sketch"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><link data-react-helmet="true" rel="shortcut icon" href="/sketch-website/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://kcf-jackson.github.io/sketch-website/docs/"><link data-react-helmet="true" rel="alternate" href="https://kcf-jackson.github.io/sketch-website/docs/" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://kcf-jackson.github.io/sketch-website/docs/" hreflang="x-default"><link rel="stylesheet" href="/sketch-website/assets/css/styles.8ccdf222.css">
<link rel="preload" href="/sketch-website/assets/js/styles.8e47b7d9.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/runtime~main.90ccf38e.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/main.2a9064b4.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/1.601f8a21.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/2.f3d55e96.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/96.3cd994a1.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/98.96910ac0.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/935f2afb.ac846fd7.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/17896441.67a700c2.js" as="script">
<link rel="preload" href="/sketch-website/assets/js/d589d3a7.aea0546b.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#main" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle" type="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/sketch-website/"><strong class="navbar__title">Sketch</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/sketch-website/blog/">News</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/sketch-website/docs/">Docs</a><a class="navbar__item navbar__link" href="/sketch-website/tutorial/">Tutorial</a><a class="navbar__item navbar__link" href="/sketch-website/showcase/">Showcase</a><a class="navbar__item navbar__link" href="/sketch-website/api/">API</a><a href="https://github.com/kcf-jackson/sketch" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_GrZ2"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_71bT">🌜</span></div><div class="react-toggle-track-x"><span class="toggle_71bT">🌞</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/sketch-website/"><strong class="navbar__title">Sketch</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" href="/sketch-website/blog/">News</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/sketch-website/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/sketch-website/tutorial/">Tutorial</a></li><li class="menu__list-item"><a class="menu__link" href="/sketch-website/showcase/">Showcase</a></li><li class="menu__list-item"><a class="menu__link" href="/sketch-website/api/">API</a></li><li class="menu__list-item"><a href="https://github.com/kcf-jackson/sketch" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper main-docs-wrapper"><div class="docPage_31aa"><div class="docSidebarContainer_3Kbt" role="complementary"><div class="sidebar_15mo"><div class="menu menu--responsive thin-scrollbar menu_Bmed"><button aria-label="Open menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_fgN0" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting started</a><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/sketch-website/docs/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sketch-website/docs/configuration">Configuration</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sketch-website/docs/debugging">Debugging</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/sketch-website/docs/manage_assets_and_deployment">Managing assets and Deployment</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Developing JavaScript in R</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/r-to-js-transpilation">Transpiling R to JavaScript</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/pitfalls">Pitfalls</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/guides">JavaScript / CSS libraries</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/dom">The DOM module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/R6-OOP">Object-Oriented Programming</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/websocket">WebSocket</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/testing">Testing</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/customisation">Customisation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/usage_with_Rmarkdown">Usage with R Markdown documents</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/sketch-website/docs/usage_with_shiny">Usage with Shiny</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/sketch-website/docs/about">About</a></li></ul></div></div></div><main class="docMainContainer_3ufF"><div class="container padding-vert--lg docItemWrapper_3FMP"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><header><h1 class="docTitle_3a4h">Introduction</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p><code>sketch</code> is an R package for creating animated and interactive
visualisations. It lets users develop JavaScript-style visualisations
using the R syntax, and it is designed to help</p><ul><li>researchers create domain specific visualisation to support
development and sharing of research,</li><li>journalists and science communicators publish high-quality and
engaging interactive graphics,</li><li>business users make customised in-house reports, and</li><li>general users learn generative arts and interactive data
visualisation.</li></ul><p>In the core, the package is a transpiler which converts R code into
JavaScript code. It does so by rewriting an R parse tree into a
JavaScript one. Here is an illustration.</p><img src="../img/ast_transform.png"><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="installation"></a>Installation<a class="hash-link" href="#installation" title="Direct link to heading">#</a></h3><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly r"><div tabindex="0" class="prism-code language-r codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">install.packages(&quot;sketch&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># For the development version</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># install.packages(&quot;remotes&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">remotes::install_github(&quot;kcf-jackson/sketch&quot;, &quot;develop&quot;)</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="running-a-sketch-r-file"></a>Running a sketch R file<a class="hash-link" href="#running-a-sketch-r-file" title="Direct link to heading">#</a></h3><p>There are two ways to run a sketch R file.</p><ol><li><p>Save the sketch R file (with the usual .R extension), then call
<code>sketch::source_r</code> with it.</p></li><li><p>If you use RStudio, there is an add-in “source a sketch R file”
listed under this package (consider binding that to the key
combination alt-shift-s), and that sources the active tab in the
editor. Alternatively, you can call the <code>source_active()</code> function.</p></li></ol><hr><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="first-example-with-sketch"></a>First example with sketch<a class="hash-link" href="#first-example-with-sketch" title="Direct link to heading">#</a></h2><p>(In the following example, please use <code>source_r</code> with the option
<code>deparsers = default_2_deparsers()</code>.)</p><p>As the first example with <strong>sketch</strong>, we will use
<a href="https://p5js.org/" target="_blank" rel="noopener noreferrer">p5.js</a> to make this animated visualisation:</p><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;/&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/gh/kcf-jackson/sketch-js/bin/dist/browser-R_core.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;data:application/javascript;base64,dmFyIHBlcnNvbiA9IGZ1bmN0aW9uKGlkKSB7CiAgICByZXR1cm4geyAiaWQiOiBpZCwgIngiOiBSLnJ1bmlmKDEsIDAsIDQwMCksICJ5IjogUi5ydW5pZigxLCAwLCAzMDApLCAidngiOiBSLnJ1bmlmKDEsIC0yLCAyKSwgInZ5IjogUi5ydW5pZigxLCAtMiwgMikgfQp9CnZhciBtb3ZlID0gZnVuY3Rpb24ocGVyc29uKSB7CiAgICB2YXIgbmV3X3ggPSBSLmFkZChwZXJzb24ueCwgcGVyc29uLnZ4KQogICAgdmFyIG5ld195ID0gUi5hZGQocGVyc29uLnksIHBlcnNvbi52eSkKICAgIGlmIChSLm9yKFIuTFQobmV3X3gsIDApLCBSLkdUKG5ld194LCA0MDApKSkgewogICAgICAgIHBlcnNvbi52eCA9IFIubXVsdGlwbHkocGVyc29uLnZ4LCAtMSkKICAgIH0gZWxzZSB7CiAgICAgICAgcGVyc29uLnggPSBuZXdfeAogICAgfQogICAgaWYgKFIub3IoUi5MVChuZXdfeSwgMCksIFIuR1QobmV3X3ksIDMwMCkpKSB7CiAgICAgICAgcGVyc29uLnZ5ID0gUi5tdWx0aXBseShwZXJzb24udnksIC0xKQogICAgfSBlbHNlIHsKICAgICAgICBwZXJzb24ueSA9IG5ld195CiAgICB9CiAgICByZXR1cm4gbnVsbAp9CnZhciByYWRpdXMgPSA1CnZhciBwZW9wbGUgPSBSLm1hcChSLnNlcSgxLCA1MCksIHBlcnNvbikKdmFyIHNldHVwID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gY3JlYXRlQ2FudmFzKDQwMCwgMzAwKQp9CnZhciBkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICBiYWNrZ3JvdW5kKDAsIDAsIDMzKQogICAgZm9yIChsZXQgcGVyc29uIG9mIHBlb3BsZSkgewogICAgICAgIGZpbGwoMTkwLCAxMjgsIDApCiAgICAgICAgY2lyY2xlKHBlcnNvbi54LCBwZXJzb24ueSwgUi5tdWx0aXBseSgyLCByYWRpdXMpKQogICAgICAgIG1vdmUocGVyc29uKQogICAgfQogICAgcmV0dXJuIG51bGwKfQo=&quot;&gt;&lt;/script&gt; &lt;/body&gt;
&lt;/html&gt;" class="border-none width-420 height-330"></iframe><ul><li><p>An important aspect of this package is that “Apps” produced by
sketch run in the browser natively without an R back-end. The App is
live, and it supports interactivity.</p></li><li><p>In fact, you can write sketch code directly in R Markdown documents,
generate an HTML file, and share it online easily (just like this
page you are reading right now!).</p></li><li><p>p5.js is chosen here because it has an user-friendly API and many
good learning resources online.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="i-basic-structure"></a>i. Basic structure<a class="hash-link" href="#i-basic-structure" title="Direct link to heading">#</a></h3><p>The structure of a p5 application looks like this:</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="mainr"></a>main.R<a class="hash-link" href="#mainr" title="Direct link to heading">#</a></h4><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sketch"><div tabindex="0" class="prism-code language-sketch codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#! load_library(&quot;p5&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">setup &lt;- function() {       </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    createCanvas(400, 300)  # create a canvas of size 400 x 300 (w x h)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">draw &lt;- function() {        </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    background(0, 0, 33)    # paint the background with the RGB colour</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    fill(&quot;red&quot;)             # change fill colour to &quot;red&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    circle(200, 150, 50)    # draw a circle (x, y, diameter)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;/&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/gh/kcf-jackson/sketch-js/bin/dist/browser-R_core.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;data:application/javascript;base64,dmFyIHNldHVwID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gY3JlYXRlQ2FudmFzKDQwMCwgMzAwKQp9CnZhciBkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICBiYWNrZ3JvdW5kKDAsIDAsIDMzKQogICAgZmlsbCgicmVkIikKICAgIHJldHVybiBjaXJjbGUoMjAwLCAxNTAsIDUwKQp9Cg==&quot;&gt;&lt;/script&gt; &lt;/body&gt;
&lt;/html&gt;" class="border-none width-420 height-330"></iframe><ul><li><p><code>#! load_library</code> is used to load the p5 library. Despite being
commented out, lines starting with <code>#!</code> are actually processed by
the <strong>sketch</strong> package.</p></li><li><p>p5.js looks for functions named (specifically) <code>setup</code> and <code>draw</code>,
and it runs</p><ul><li><code>setup</code> once at the start of the App, and</li><li><code>draw</code> iteratively 60 times per second after the App starts.</li></ul></li><li><p><code>createCanvas</code>, <code>background</code>, <code>fill</code> and <code>circle</code> are functions
provided by p5.js for drawing on the screen.</p></li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="ii-add-more-circles"></a>ii. Add more circles<a class="hash-link" href="#ii-add-more-circles" title="Direct link to heading">#</a></h3><p>Let’s create a <code>person</code> object, and draw 50 of them on the screen. We
need an <code>id</code> to identify the person and its coordinates <code>x</code> and <code>y</code> at
which a circle will be drawn.</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sketch"><div tabindex="0" class="prism-code language-sketch codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#! load_library(&quot;p5&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain"># Make a &quot;person&quot; object</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">person &lt;- function(id) {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    list(id = id, x = runif(1, 0, 400), y = runif(1, 0, 300))</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain"># Set up variables</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">radius &lt;- 5</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">people &lt;- map(1:50, person)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">setup &lt;- function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    createCanvas(400, 300)  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">draw &lt;- function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    background(0, 0, 33)    </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    for (person in people) {   # Use a for loop to draw one person at a time</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        fill(190, 128, 0)                </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        circle(person$x, person$y, 2*radius)   </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NULL</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;/&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/gh/kcf-jackson/sketch-js/bin/dist/browser-R_core.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;data:application/javascript;base64,dmFyIHBlcnNvbiA9IGZ1bmN0aW9uKGlkKSB7CiAgICByZXR1cm4geyAiaWQiOiBpZCwgIngiOiBSLnJ1bmlmKDEsIDAsIDQwMCksICJ5IjogUi5ydW5pZigxLCAwLCAzMDApIH0KfQp2YXIgcmFkaXVzID0gNQp2YXIgcGVvcGxlID0gUi5tYXAoUi5zZXEoMSwgNTApLCBwZXJzb24pCnZhciBzZXR1cCA9IGZ1bmN0aW9uKCkgewogICAgcmV0dXJuIGNyZWF0ZUNhbnZhcyg0MDAsIDMwMCkKfQp2YXIgZHJhdyA9IGZ1bmN0aW9uKCkgewogICAgYmFja2dyb3VuZCgwLCAwLCAzMykKICAgIGZvciAobGV0IHBlcnNvbiBvZiBwZW9wbGUpIHsKICAgICAgICBmaWxsKDE5MCwgMTI4LCAwKQogICAgICAgIGNpcmNsZShwZXJzb24ueCwgcGVyc29uLnksIFIubXVsdGlwbHkoMiwgcmFkaXVzKSkKICAgIH0KICAgIHJldHVybiBudWxsCn0K&quot;&gt;&lt;/script&gt; &lt;/body&gt;
&lt;/html&gt;" class="border-none width-420 height-330"></iframe><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="iii-add-movements"></a>iii. Add movements<a class="hash-link" href="#iii-add-movements" title="Direct link to heading">#</a></h3><p>To make the people move, we add two velocity states <code>vx</code> and <code>vy</code> to the
“person” object and a function that changes a person’s position based on
its velocity.</p><p>An important point to notice is that JavaScript* passes object by
reference, so when you pass an object to a function and make changes to
it, the changes applies to the object directly and no copying occurs. To
clarify this point, the super-assign symbol <code>&lt;&lt;-</code> is used below to
indicate where one should expect object modification.</p><p>(*Did you notice you have been writing JavaScript?)</p><div class="codeBlockContainer_K1bP"><div class="codeBlockContent_hGly sketch"><div tabindex="0" class="prism-code language-sketch codeBlock_23N8 thin-scrollbar"><div class="codeBlockLines_39YC" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">#! load_library(&quot;p5&quot;)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Make a &quot;person&quot; object</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">person &lt;- function(id) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    list(id = id, x = runif(1, 0, 400), y = runif(1, 0, 300),</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">         vx = runif(1, -2, 2), vy = runif(1, -2, 2))  # Add velocity</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">move &lt;- function(person) {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    new_x &lt;- person$x + person$vx     # Update position</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    new_y &lt;- person$y + person$vy</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    # If the new position is out of the screen, the person should turn back!</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    # Otherwise, move to the new position</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    if (new_x &lt; 0 || new_x &gt; 400) { </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        person$vx &lt;&lt;- person$vx * -1  # Turn back!</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        person$x &lt;&lt;- new_x            # Move to the new position</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    # Do the same for y</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    if (new_y &lt; 0 || new_y &gt; 300) { </span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        person$vy &lt;&lt;- person$vy * -1  # Turn back!</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    } else {</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        person$y &lt;&lt;- new_y            # Move to the new position</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">    NULL</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"># Set up variables</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">radius &lt;- 5</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">people &lt;- map(1:50, person)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">setup &lt;- function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    createCanvas(400, 300)  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">draw &lt;- function() {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    background(0, 0, 33)    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    for (person in people) {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        fill(190, 128, 0)                </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">        circle(person$x, person$y, 2*radius)</span></div><div class="token-line docusaurus-highlight-code-line" style="color:#bfc7d5"><span class="token plain">        move(person)                  # Call `move` here</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    }</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    NULL</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_Ue-o">Copy</button></div></div><iframe srcdoc="&lt;!DOCTYPE html&gt;
&lt;html&gt; &lt;head&gt; &lt;meta charset=&quot;utf-8&quot;/&gt; &lt;script src=&quot;https://cdn.jsdelivr.net/gh/kcf-jackson/sketch-js/bin/dist/browser-R_core.js&quot;&gt;&lt;/script&gt; &lt;script src=&quot;https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.0.0/p5.min.js&quot;&gt;&lt;/script&gt; &lt;/head&gt; &lt;body&gt; &lt;script src=&quot;data:application/javascript;base64,dmFyIHBlcnNvbiA9IGZ1bmN0aW9uKGlkKSB7CiAgICByZXR1cm4geyAiaWQiOiBpZCwgIngiOiBSLnJ1bmlmKDEsIDAsIDQwMCksICJ5IjogUi5ydW5pZigxLCAwLCAzMDApLCAidngiOiBSLnJ1bmlmKDEsIC0yLCAyKSwgInZ5IjogUi5ydW5pZigxLCAtMiwgMikgfQp9CnZhciBtb3ZlID0gZnVuY3Rpb24ocGVyc29uKSB7CiAgICB2YXIgbmV3X3ggPSBSLmFkZChwZXJzb24ueCwgcGVyc29uLnZ4KQogICAgdmFyIG5ld195ID0gUi5hZGQocGVyc29uLnksIHBlcnNvbi52eSkKICAgIGlmIChSLm9yKFIuTFQobmV3X3gsIDApLCBSLkdUKG5ld194LCA0MDApKSkgewogICAgICAgIHBlcnNvbi52eCA9IFIubXVsdGlwbHkocGVyc29uLnZ4LCAtMSkKICAgIH0gZWxzZSB7CiAgICAgICAgcGVyc29uLnggPSBuZXdfeAogICAgfQogICAgaWYgKFIub3IoUi5MVChuZXdfeSwgMCksIFIuR1QobmV3X3ksIDMwMCkpKSB7CiAgICAgICAgcGVyc29uLnZ5ID0gUi5tdWx0aXBseShwZXJzb24udnksIC0xKQogICAgfSBlbHNlIHsKICAgICAgICBwZXJzb24ueSA9IG5ld195CiAgICB9CiAgICByZXR1cm4gbnVsbAp9CnZhciByYWRpdXMgPSA1CnZhciBwZW9wbGUgPSBSLm1hcChSLnNlcSgxLCA1MCksIHBlcnNvbikKdmFyIHNldHVwID0gZnVuY3Rpb24oKSB7CiAgICByZXR1cm4gY3JlYXRlQ2FudmFzKDQwMCwgMzAwKQp9CnZhciBkcmF3ID0gZnVuY3Rpb24oKSB7CiAgICBiYWNrZ3JvdW5kKDAsIDAsIDMzKQogICAgZm9yIChsZXQgcGVyc29uIG9mIHBlb3BsZSkgewogICAgICAgIGZpbGwoMTkwLCAxMjgsIDApCiAgICAgICAgY2lyY2xlKHBlcnNvbi54LCBwZXJzb24ueSwgUi5tdWx0aXBseSgyLCByYWRpdXMpKQogICAgICAgIG1vdmUocGVyc29uKQogICAgfQogICAgcmV0dXJuIG51bGwKfQo=&quot;&gt;&lt;/script&gt; &lt;/body&gt;
&lt;/html&gt;" class="border-none width-420 height-330"></iframe><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="summary"></a>Summary<a class="hash-link" href="#summary" title="Direct link to heading">#</a></h3><p>We have learnt that</p><ul><li><code>#! load_library(&quot;p5&quot;)</code> is used to load the
<a href="http://p5js.org/" target="_blank" rel="noopener noreferrer">p5.js</a> library,</li><li><code>setup</code> and <code>draw</code> form the basic structure of a p5 canvas,</li><li><code>background</code>, <code>fill</code> and <code>circle</code> are drawing functions from p5.js,
and</li><li>JavaScript passes object by reference.</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_2LWZ" id="next-step"></a>Next step<a class="hash-link" href="#next-step" title="Direct link to heading">#</a></h2><p>That’s it! You have successfully created a JavaScript visualisation
without actually writing any JavaScript! I hope you find the examples
easy to follow and are convinced that using JavaScript - even to a great
extent - does not need to be hard. Leveraging the existing JavaScript
libraries, <strong>sketch</strong> opens up many new possibilities with
visualisations. For the next step,</p><ul><li><p>see <a href="/sketch-website/showcase/">Showcase</a> for some use cases,</p></li><li><p>see <a href="/sketch-website/tutorial/">Tutorial</a> to explore other visualisations - this is
the main avenue to learn how to use the package,</p></li><li><p>see <a href="/sketch-website/api/">API</a> for full API documentation, or</p></li><li><p>continue to the next section to learn more about the details of the
package (it is recommeded to visit this after one has followed
through a couple of the tutorials).</p></li></ul><link href="../css/docs-styles.css" rel="stylesheet"></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/kcf-jackson/sketch-website/edit/master/docs/getting-started.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-label="Edit page"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Docs pages navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/sketch-website/docs/configuration"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Configuration »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a><ul><li><a href="#installation" class="table-of-contents__link">Installation</a></li><li><a href="#running-a-sketch-r-file" class="table-of-contents__link">Running a sketch R file</a></li></ul></li><li><a href="#first-example-with-sketch" class="table-of-contents__link">First example with sketch</a><ul><li><a href="#i-basic-structure" class="table-of-contents__link">i. Basic structure</a></li><li><a href="#ii-add-more-circles" class="table-of-contents__link">ii. Add more circles</a></li><li><a href="#iii-add-movements" class="table-of-contents__link">iii. Add movements</a></li><li><a href="#summary" class="table-of-contents__link">Summary</a></li></ul></li><li><a href="#next-step" class="table-of-contents__link">Next step</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sketch-website/docs/">Getting Started</a></li><li class="footer__item"><a class="footer__link-item" href="/sketch-website/docs/guides">Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/sketch-website/api/">API</a></li><li class="footer__item"><a class="footer__link-item" href="/sketch-website/docs/about">About</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sketch-website/tutorial/">Tutorial</a></li><li class="footer__item"><a class="footer__link-item" href="/sketch-website/showcase/">Showcase</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">More</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/sketch-website/blog">News</a></li><li class="footer__item"><a href="https://github.com/kcf-jackson/sketch" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub</a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2020-2021 Chun Fung Kwok, Kate Saunders | Apache-2.0 Licensed | Built with Docusaurus</div></div></div></footer></div>
<script src="/sketch-website/assets/js/styles.8e47b7d9.js"></script>
<script src="/sketch-website/assets/js/runtime~main.90ccf38e.js"></script>
<script src="/sketch-website/assets/js/main.2a9064b4.js"></script>
<script src="/sketch-website/assets/js/1.601f8a21.js"></script>
<script src="/sketch-website/assets/js/2.f3d55e96.js"></script>
<script src="/sketch-website/assets/js/96.3cd994a1.js"></script>
<script src="/sketch-website/assets/js/98.96910ac0.js"></script>
<script src="/sketch-website/assets/js/935f2afb.ac846fd7.js"></script>
<script src="/sketch-website/assets/js/17896441.67a700c2.js"></script>
<script src="/sketch-website/assets/js/d589d3a7.aea0546b.js"></script>
</body>
</html>